import pandas as pd
import matplotlib.pyplot as plt

# ğŸ“Œ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
def analyze_sales(df):
    """ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª"""
    print(f"ğŸ§¾ Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±: {df.shape[0]}")
    print(f"ğŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: {df['total'].sum():,.2f}")
    print(f"ğŸ“ˆ Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©: {df['total'].mean():,.2f}")
    print("â­ Ø£Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬ Ù…Ø¨ÙŠØ¹Ù‹Ø§:")
    print(df['product'].value_counts().head(1))
    print("\nğŸ“Š Ø£ÙØ¶Ù„ 5 Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø§Ù„ØµØ±Ù:")
    print(df.groupby('customer_id')['total'].sum().sort_values(ascending=False).head(5))

    # Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
    top_customers = df.groupby('customer_id')['total'].sum().sort_values(ascending=False).head(5)
    top_customers.plot(kind='bar', title='Ø£ÙØ¶Ù„ 5 Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø§Ù„ØµØ±Ù')
    plt.ylabel('Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ')
    plt.xlabel('Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù…ÙŠÙ„')
    plt.show()
====================================================================================================
# ğŸ“Œ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰
def analyze_visits(df):
    """ØªØ­Ù„ÙŠÙ„ Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰"""
    print(f"ğŸ‘¨â€âš•ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø¶Ù‰: {df['patient_id'].nunique()}")
    print(f"ğŸ—“ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: {df.shape[0]}")
    print("ğŸ“ Ø£ÙƒØ«Ø± Ø¹ÙŠØ§Ø¯Ø© Ø²ÙŠØ§Ø±Ø©:")
    print(df['clinic'].value_counts().head(1))
    print(f"\nğŸ“… Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: {df[df['visit_date'].dt.month == pd.Timestamp.today().month].shape[0]}")

    # Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ø£ÙƒØ«Ø± Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª Ø²ÙŠØ§Ø±Ø©
    df['clinic'].value_counts().head(5).plot(kind='barh', title='Ø£ÙƒØ«Ø± 5 Ø¹ÙŠØ§Ø¯Ø§Øª Ø²ÙŠØ§Ø±Ø©')
    plt.xlabel('Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª')
    plt.ylabel('Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©')
    plt.gca().invert_yaxis()
    plt.show()
====================================================================================================
# ğŸ“Œ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
def analyze_inventory(df):
    """ØªØ­Ù„ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"""
    print(f"ğŸ“¦ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: {df.shape[0]}")
    print("ğŸ”» Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†:")
    print(df[df['quantity'] < 10][['item_name', 'quantity']])

    # Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙÙŠ Ø§Ù„ÙƒÙ…ÙŠØ©
    df.sort_values('quantity', ascending=False).head(10).set_index('item_name')['quantity'].plot(kind='barh', title='Ø£Ø¹Ù„Ù‰ 10 Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø§Ù„Ù…Ø®Ø²ÙˆÙ†')
    plt.xlabel('Ø§Ù„ÙƒÙ…ÙŠØ©')
    plt.gca().invert_yaxis()
    plt.show()
====================================================================================================
# ğŸ“Œ Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
def analyze_kpis(df):
    """ØªØ­Ù„ÙŠÙ„ Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡"""
    print(f"ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª: {df.shape[0]}")
    achieved = (df['actual'] >= df['target']).sum()
    ratio = achieved / df.shape[0]
    print(f"âœ… Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©: {ratio:.2%}")
    print("\nâŒ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…ØªØ¹Ø«Ø±Ø©:")
    print(df[df['actual'] < df['target']][['kpi_name', 'target', 'actual']])

    # Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø¯Ø§Ø¦Ø±ÙŠ Ù„Ù„Ù…Ø¤Ø´Ø±Ø§Øª
    plt.pie([achieved, df.shape[0] - achieved], labels=['Ù…Ø­ÙÙ‚Ù‘Ù‚Ø©', 'Ù…ØªØ¹ÙØ«Ù‘Ø±Ø©'], autopct='%1.1f%%', startangle=90)
    plt.title('Ù†Ø³Ø¨Ø© ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª')
    plt.axis('equal')
    plt.show()


====================================================================================================
ØªØ­Ø§Ù„ÙŠÙ„ Ø¹Ø§Ù…Ù‡ :

import pandas as pd
import matplotlib.pyplot as plt

# ğŸ“Œ Ø¯Ø§Ù„Ø© 1: ØªØ­Ù„ÙŠÙ„ Ø¹Ø§Ù… Ù„Ø£ÙŠ Ø¬Ø¯ÙˆÙ„ ÙÙŠÙ‡ ØªÙˆØ§Ø±ÙŠØ®
def analyze_by_date(df, date_column):
    """
    ØªØ­Ù„ÙŠÙ„ Ø¨Ø³ÙŠØ· Ù„Ù„ØªÙˆØ§Ø±ÙŠØ®: Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ø§Ù„Ø´Ù‡Ø±
    """
    df[date_column] = pd.to_datetime(df[date_column])  # ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®
    monthly_counts = df[date_column].dt.to_period("M").value_counts().sort_index()

    print("ğŸ“† Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù„ÙƒÙ„ Ø´Ù‡Ø±:")
    print(monthly_counts)

    monthly_counts.plot(kind="bar", figsize=(12, 5), title="ğŸ“Š Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©")
    plt.xlabel("Ø§Ù„Ø´Ù‡Ø±")
    plt.ylabel("Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª")
    plt.grid(True)
    plt.tight_layout()
    plt.show()
====================================================================================================

# ğŸ“Œ Ø¯Ø§Ù„Ø© 2: ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ§Øª â€“ ØªØµÙ„Ø­ Ù„Ù„Ù…Ø®Ø²ÙˆÙ† Ø£Ùˆ Ø§Ù„Ù…Ø±Ø¶Ù‰ Ø£Ùˆ Ø§Ù„Ø·Ù„Ø¨ÙŠØ§Øª
def analyze_quantity(df, item_column, quantity_column, top_n=10):
    """
    Ø¹Ø±Ø¶ Ø£ÙƒØ«Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù†ØªØ´Ø§Ø±Ù‹Ø§ Ø£Ùˆ Ø·Ù„Ø¨Ù‹Ø§
    """
    item_counts = df.groupby(item_column)[quantity_column].sum().sort_values(ascending=False).head(top_n)

    print("ğŸ·ï¸ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ±:")
    print(item_counts)

    item_counts.plot(kind="bar", figsize=(12, 5), title="ğŸ“¦ Ø£ÙƒØ«Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø´ÙŠÙˆØ¹Ù‹Ø§")
    plt.xlabel("Ø§Ù„Ø¹Ù†ØµØ±")
    plt.ylabel("Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ")
    plt.grid(True)
    plt.tight_layout()
    plt.show()
====================================================================================================

# ğŸ“Œ Ø¯Ø§Ù„Ø© 3: ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨ (Ù…Ø«Ù„Ø§Ù‹ Ù‡Ù„ ØªÙ… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø£Ù… Ù„Ø§ â€“ Ù„Ù„Ù€ KPI Ø£Ùˆ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø±Ø¶Ù‰)
def analyze_status_ratio(df, status_column, target_value='Achieved'):
    """
    ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø­Ù‚Ù‚Ø© Ù…Ù‚Ø§Ø¨Ù„ ØºÙŠØ± Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©
    """
    counts = df[status_column].value_counts(normalize=True) * 100

    print("ğŸ“ˆ Ù†Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø§Øª:")
    print(counts.round(2))

    counts.plot(kind="pie", autopct='%1.1f%%', title="ğŸ¯ Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡", figsize=(6, 6))
    plt.ylabel("")
    plt.tight_layout()
    plt.show()
====================================================================================================

# ğŸ“Œ Ø¯Ø§Ù„Ø© 4: ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø­Ø³Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø©
def top_entity_by_value(df, entity_column, value_column, top_n=5):
    """
    Ø¹Ø±Ø¶ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª (Ù…Ø«Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø£Ùˆ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†) Ø­Ø³Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø©
    """
    totals = df.groupby(entity_column)[value_column].sum().sort_values(ascending=False).head(top_n)

    print(f"ğŸ” Ø£Ø¹Ù„Ù‰ {entity_column}:")
    print(totals)

    totals.plot(kind="bar", figsize=(10, 5), title=f"ğŸ† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø­Ø³Ø¨ {value_column}")
    plt.xlabel(entity_column)
    plt.ylabel("Ø§Ù„Ù‚ÙŠÙ…Ø©")
    plt.grid(True)
    plt.tight_layout()
    plt.show()
====================================================================================================
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# âœ… 1. Ø¯Ø§Ù„Ø© ØªÙ„Ø®ÙŠØµ Ø°ÙƒÙŠØ© Ù„Ø£ÙŠ DataFrame
def summarize_dataframe(df):
    """Ø·Ø¨Ø§Ø¹Ø© Ù…Ù„Ø®Øµ Ø¥Ø­ØµØ§Ø¦ÙŠ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª"""
    print("ğŸ§¾ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ Ã— Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:", df.shape)
    print("\nğŸ” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:")
    print(df.dtypes)
    
    print("\nğŸ“‰ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ§Ø±ØºØ© Ù„ÙƒÙ„ Ø¹Ù…ÙˆØ¯:")
    print(df.isnull().sum())
    
    print("\nğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:")
    display(df.describe(include='all').transpose())
====================================================================================================
# âœ… 2. Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø³Ù„Ø³Ù„Ø© Ø²Ù…Ù†ÙŠØ© (Time Series)
def plot_time_series(df, date_col, value_col):
    """
    ØªØ±Ø³Ù… ØªØ·ÙˆØ± Ø§Ù„Ù‚ÙŠÙ… Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª (Ù…Ù…ØªØ§Ø² Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª).
    df: Ø¨ÙŠØ§Ù†Ø§ØªÙƒ
    date_col: Ø§Ø³Ù… Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªØ§Ø±ÙŠØ®
    value_col: Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªØ­Ù„ÙŠÙ„Ù‡ Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†
    """
    df[date_col] = pd.to_datetime(df[date_col])  # Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ ØªØ§Ø±ÙŠØ®
    df_sorted = df.sort_values(by=date_col)
    
    plt.figure(figsize=(12, 6))
    plt.plot(df_sorted[date_col], df_sorted[value_col], marker='o')
    plt.title(f"ğŸ“ˆ {value_col} Ø¹Ø¨Ø± {date_col}")
    plt.xlabel("Ø§Ù„ØªØ§Ø±ÙŠØ®")
    plt.ylabel(value_col)
    plt.grid(True)
    plt.tight_layout()
    plt.show()
====================================================================================================
# âœ… 3. Ø¯Ø§Ù„Ø© Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù‚ÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø© (Group By)
def compare_groups(df, group_col, value_col):
    """
    ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù‚ÙŠÙ… Ø­Ø³Ø¨ ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© (Ù…Ø«Ù„ Ø§Ù„Ù…ØªÙˆØ³Ø·ØŒ Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØŒ Ø§Ù„Ø¹Ø¯Ø¯).
    Ù…ÙÙŠØ¯ Ø¬Ø¯Ù‹Ø§ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„ÙØ¦Ø§Øª.
    
    df: DataFrame
    group_col: Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ø§Ù„ÙØ¦Ø§Øª (Ù…Ø«Ù„ Ø§Ù„Ø¬Ù†Ø³ØŒ Ø§Ù„ÙØ±Ø¹ØŒ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©)
    value_col: Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªÙ„Ø®ÙŠØµÙ‡ (Ù…Ø«Ù„ Ø§Ù„ØªÙƒÙ„ÙØ©ØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø¶Ù‰)
    """
    summary = df.groupby(group_col)[value_col].agg(['count', 'mean', 'std', 'min', 'max']).reset_index()
    print(f"ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© {value_col} Ø­Ø³Ø¨ {group_col}:")
    display(summary)
